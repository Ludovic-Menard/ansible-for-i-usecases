---
- name: Get valid backup list, most recent first
  hosts: localhost
  vars:
    csm_server:
      hostname: lbsserv36.tuc.stglabs.ibm.com
      port: 9559
      username: csmadmin
      password: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          66343635666239613636393964653337653134313535666336663961366335636330313132363637
          3136623934363563343766366165383432613661333533350a643666663833346338313939666561
          33616636393230323731326435636662333635663032663833366137663966326331396364313933
          3062303363366231660a623461633032343066623462303534656536346237666566376562643565
          3830
    sgc_session: "SGC_DB2_LBSFS5200A"

  tasks:
    - name: Get valid backup list for Session {{ sgc_session }}, most recent first
      ibm_sgc_get_backups:
        hostname: "{{ csm_server.hostname }}"
        username: "{{ csm_server.username }}"
        password: "{{ csm_server.password }}"
        session: "{{ sgc_session }}"
        only_valid: yes
        newest_first: yes
      no_log: true
      register: csm_result

    - debug:
        var: csm_result